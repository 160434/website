%h1
  - if (ctx.team.application)
    = ctx.team.application + ' by '
  = ctx.team.name

- if (ctx.editAllowed)
  %form{ method: 'POST', action: '/teams/' + ctx.team.toParam() }#delete
    %a.button{ href: '/teams/' + ctx.team.toParam() + '/edit' } Edit
    %input{ type: 'hidden', name: '_method', value: 'delete' }
    %input.button{ type: 'submit', rel: 'nofollow', value: 'Delete', onclick: "return confirm('Are you sure you want to delete this team?');" }

- if (!ctx.editAllowed)
  %p.note
    You&rsquo;re looking at the
    %a{ href: '/' } Node.js Knockout
    team profile for
    != ' <a href="/teams/' + ctx.team.toParam() + '">' + ctx.team.name + '</a>.'

- if (ctx.editAllowed)
  - if (!ctx.team.application)
    %p.note
      You don&rsquo;t have a description for your application yet.
      %a{ href: '/teams/' + ctx.team.toParam() + '/edit' } Edit now
  - if (!ctx.currentPerson)
    %p.note
      Nice work! Your team,
      != ' <a href="/teams/' + ctx.team.toParam() + '">' + ctx.team.name + '</a>, '
      is officially registered for Node.js Knockout.
    
    %p.note
      %strong
        An invitation email with log-in information has been sent to each team member.
      All team members now need to
      %a{ href: '/login' } sign in and update their profile information.

%h3 Team Members

%ul#members
  - each member in ctx.members
    %li
      - if (member.link)
        %a{ href: member.link }= member.name
      - if (!member.link)
        = member.name
      - if (ctx.currentPerson && member.id() === ctx.currentPerson.id())
        &nbsp;&ndash;
        %a{ href: '/people/' + member.toParam() + '/edit' } that&rsquo;s you!
  - if (ctx.invites.length && ctx.editAllowed)
    - each invite in ctx.invites
      %li
        %a{ href: 'mailto:' + invite.email }= invite.email
        invited
        &nbsp;&ndash;&nbsp;
        %a.resend{ href: '/teams/' + ctx.team.toParam() + '/invite/' + invite.toParam() } reinvite

- if (ctx.invites.length && !ctx.editAllowed)
  %p
    = pluralize(ctx.invites.length, 'outstanding invitation')

- if (ctx.team.application)
  %h3 Description
  != markdown(ctx.team.description)
  %h3 Colophon
  != markdown(ctx.team.colophon)
  %h3 Screencast / Info URL
  %a{ href: ctx.team.link }= ctx.team.link

.clear

- if (ctx.isAdmin)
  %h1 Votes
  - if (ctx.vote.isNew())
    %form#your_vote{ method: 'POST', action: '/teams/' + ctx.team.toParam() + '/votes' }
      .voter
        %h3 Your Vote
        != partial('votes/voter.html.haml', { locals: { vote: ctx.vote }})
      .vote
        != partial('votes/stars.html.haml', { locals: { vote: ctx.vote }})
        %textarea{ name: 'comment', id: 'comment', placeholder: '2-3 sentence review. Optional.', rows: 4 }= ctx.vote.comment || ''
        - if (!ctx.currentPerson)
          .email_input
            %input.email{ type: 'text', name: 'email', id: 'email', value: ctx.vote.email || '', placeholder: 'email@address.com' }
              &nbsp;or
              %a{ href: '/login?return_to=' + escapeURL('/teams/' + ctx.team.toParam() + '#draft') } Sign in
            .note Required to confirm your vote. We don't spam.
        - if (ctx.currentPerson)
          .note.email_hidden
            Voting as
            = ' ' + ctx.vote.email + ' '
            &mdash;
            %a{ href: '/logout?return_to=' + escapeURL('/teams/' + ctx.team.toParam() + '#draft') } Change
        %input.button{ type: 'submit', value: 'Vote!' }
        .clear

  %ul.votes
    != partial('votes/index.html.jade', { locals: { ctx: ctx } })
    - if (ctx.votes.length == 50)
      .more
        %img{ src: '/images/spinner.gif' }
